<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Hedge.fun App</title>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js"></script>
		<link rel="stylesheet" href="css/style.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?display=swap&family=Oswald:wght@200;300;400;500;600;700&family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800">
	<link rel="icon" type="image/png" href="images/logo.png">
	</head>

	<body>

		<!-- HEADER -->
		<header class="header">
			<a href="./" class="logo"><img src="images/logo.png" alt="Hedge.fun"></a>
			<div class="header-right">
				<span id="wallet-cap" class="wallet-cap" hidden>Cap.: null SOL</span>
				<button id="connectWalletBtn" class="btn btn-round btn-connect">Connect</button>
			</div>
		</header>

		<main>
			<!-- SECTION: Connect Wallet -->
			<section id="ConnectWallet" class="section">
				<div class="connect-dashboard">
					<img src="images/Empty wallet.png" alt="Empty Wallet" class="wallet-img">
					<p>Connect your Solana wallet</p>
					<button id="connectBtn" class="btn btn-gradient btn-round">
					  Connect Wallet
					</button>
				</div>
			</section>

			<!-- SECTION: Dashboard -->
			<section id="Dashboard" class="section" hidden>
				<h2>Dashboard</h2>
				<div class="balance">
				<div class="balance-right">
					<h4>Your balance:</h4>
					<h3 id="balance__sol"></h3>
					<h3 id="balance__usd"></h3>
					<h5 id="balance__rate"></h5>
					<span id="walletStatus" style="color:#9ac31c; font-size:18px; margin-bottom:20px;">
					Not connected
					</span>
				</div>
				</div>

				<a href="#" id="hedgeBtn" class="btn btn-gradient btn-round">Hedge my position</a>

				<!-- SECTION: My Positions -->
				<section id="MyPositions" class="section" hidden>
					<h2>Hedge My Position</h2>
					<div class="table-container">
					<p>Select which assets you want to hedge (only positions above $20 are shown):</p>
					<div class="table-wrapper">
						<table class="hedge-table">
						<thead>
							<tr>
							<th>Select</th>
							<th>Asset</th>
							<th>Balance</th>
							<th>Value (USD)</th>
							</tr>
						</thead>
						<tbody>
							<tr>
							<td><input type="checkbox"></td>
							<td><img class="token-icon" data-symbol="SOL" alt="SOL"> SOL</td>
							<td>3.0</td>
							<td>$599.00</td>
							</tr>
							<tr>
							<td><input type="checkbox"></td>
							<td><img class="token-icon" data-symbol="USDC" alt="USDC"> USDC</td>
							<td>1865.00</td>
							<td>$1865.00</td>
							</tr>
							<tr>
							<td><input type="checkbox"></td>
							<td><img class="token-icon" data-symbol="BONK" alt="BONK"> BONK</td>
							<td>1542000</td>
							<td>$135.72</td>
							</tr>
						</tbody>
						</table>
					</div>
					</div>
					<a href="#" id="addHedgeBtn" class="btn btn-gradient btn-round">Add new hedge</a>
				</section>
				<script>
					function getTokenIcon(symbol) {
					const s = symbol.toUpperCase();
					// Спроба отримати іконку з CoinGecko
					const coingeckoIcons = {
						SOL: "https://assets.coingecko.com/coins/images/4128/large/solana.png",
						USDC: "https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png",
						BONK: "https://assets.coingecko.com/coins/images/28600/large/bonk.jpg"
					};
					// Якщо ні - fallback на cryptoicons
					return coingeckoIcons[s] || `https://cryptoicons.org/api/icon/${s.toLowerCase()}/64`;
					}
					// Після завантаження сторінки замінюємо src для всіх іконок
					document.addEventListener("DOMContentLoaded", () => {
					document.querySelectorAll(".token-icon").forEach(img => {
						const symbol = img.dataset.symbol;
						img.src = getTokenIcon(symbol);
						img.width = 24;
						img.height = 24;
						img.style.marginRight = "8px";
						img.style.verticalAlign = "middle";
					});
					});
				</script>

				<h3>Crypto Price Chart</h3>
				<canvas id="cryptoChart"></canvas>
				<div style="margin-top:10px; margin-bottom:20px;">
				<label><input type="radio" name="currency" value="SOL" checked> SOL</label>
				<label style="margin-left:10px;"><input type="radio" name="currency" value="USDC"> USDC</label>
				<label style="margin-left:10px;"><input type="radio" name="currency" value="MET"> $MET</label>
				<label style="margin-left:20px;"><input type="checkbox" id="toggleForecast" checked> Show Forecast</label>
				<label style="margin-left:10px;"><input type="checkbox" id="toggleEMA" checked> Show EMA</label>
				</div>
			</section>

			<!-- SECTION: Referral -->
			<section id="Referral" class="section" hidden>
				<h3>Invite your friends and earn rewards!</h3>
				<a href="#" class="btn btn-gradient btn-round">Get referral link</a>
			</section>
		</main>

		<!-- FOOTER -->
		<footer class="footer">
			<div class="footer-content">
				<a href="https://twitter.com/name" target="_blank" class="social-link">
					<img src="images/twitter.png" alt="Twitter" class="social-icon">
				</a>
				<a href="#" class="social-link">
					<img src="images/gitlab.png" alt="Gitbook" class="social-icon">
				</a>
				<a href="#" class="social-link">
					<img src="images/faq.png" alt="FAQ" class="social-icon">
				</a>
				<a href="#" class="social-link">
					<img src="images/discord.png" alt="Discord" class="social-icon">
				</a>
			</div>
		</footer>

		<!-- BACKGROUND ANIMATION -->
		<div class="crypto-bg">
			<span>₿</span>
			<span>Ξ</span>
			<span>SOL</span>
			<span>$</span>
			<span>₿</span>
			<span>Ξ</span>
			<span>SOL</span>
			<span>$</span>
		</div>

		<script>
			document.getElementById('hedgeBtn').addEventListener('click', () => {
				document.getElementById('MyPositions').hidden = false;
				});
		</script>

		<!-- Loading popup -->
		<div id="popup-overlay" class="popup-overlay">
			<div id="popup-add-hedge" class="popup">
				<img src="images/loading.png" alt="Loading" class="loading" style="width:60px; margin-bottom:20px;">
				<h3>Processing your hedge...</h3>
			</div>
		</div>

		<!-- Wallet Connect Popup -->
		<div id="popup-wallet-overlay" class="popup-overlay">
		<div id="popup-wallet" class="popup" style="max-width: 400px; text-align: center;">
			<h2 style="margin-bottom: 20px;">Connect Wallet</h2>
			<div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;">
			<button id="wallet-phantom" class="wallet-btn" style="background: none; border: none; cursor: pointer;">
				<img src="images/phantom.png" alt="Phantom" style="width:80px; height:80px;">
				<p style="color:#fff; font-size:18px;">Phantom</p>
			</button>
			<button id="wallet-backpack" class="wallet-btn" style="background: none; border: none; cursor: pointer;">
				<img src="images/backpack.png" alt="Backpack" style="width:80px; height:80px;">
				<p style="color:#fff; font-size:18px;">Backpack</p>
			</button>
			</div>

			<div id="manual-wallet" style="text-align: center;">
			<p style="color:#ccc; margin-bottom: 10px;">Or enter wallet address manually:</p>
			<form hx-post="/account" hx-swap="none" hx-on::after-request="if(event.detail.successful) this.reset()">
				<input
					name="account_id"
					id="manualWalletInput" 
					type="text" 
					placeholder="Enter wallet address" 
					style="width: 90%; padding: 10px; border-radius: 8px; border: none; font-size: 16px; text-align: center;">
				<button
					id="manualWalletBtn" 
					type="submit"
					style="margin-top: 15px; padding: 10px 25px; border: none; border-radius: 8px; background-color: #9ac31c; color: #000; font-weight: bold; cursor: pointer;">
					OK
				</button>
			</form>
			</div>
		</div>
		</div>

		<!-- Hedge Offer Popup -->
		<div id="popup-hedge-offer-overlay" class="popup-overlay">
			<div id="popup-hedge-offer" class="popup" style="max-width: 650px;">
				<h2 style="margin-bottom: 15px;">Hedge Offer</h2>
				<p style="margin-bottom: 15px;">Choose hedge position<br>Select a market to hedge your exposure.</p>

				<!-- Offer block -->
				<div style="font-family: Arial, sans-serif; color: #ffffff; background-color: #1a2a50; padding: 20px; border-radius: 12px; max-width: 600px; margin: auto;">
					<div class="table-wrapper" style="overflow-x:auto; margin-top: 10px;">
						<table style="width: 100%; border-collapse: collapse; background-color: #243b70; border-radius: 8px; overflow: hidden;">
							<thead>
								<tr style="background-color: #1f2e5a;">
									<th style="padding: 10px; text-align: left;">Market</th>
									<th style="padding: 10px; text-align: left;">% Hedge</th>
									<th style="padding: 10px; text-align: left;">Liquidity</th>
									<th style="padding: 10px; text-align: left;">Select</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td style="padding: 10px;">SOL up / down</td>
									<td style="padding: 10px;">10%</td>
									<td style="padding: 10px;">$50K</td>
									<td style="padding: 10px;"><input type="radio" name="hedge-select"></td>
								</tr>
								<tr>
									<td style="padding: 10px;">BTC up / down</td>
									<td style="padding: 10px;">15%</td>
									<td style="padding: 10px;">$120K</td>
									<td style="padding: 10px;"><input type="radio" name="hedge-select"></td>
								</tr>
							</tbody>
						</table>
					</div>

					<div style="margin-top: 20px; background-color: #243b70; padding: 10px 15px; border-radius: 8px;">
						<p style="margin-bottom: 8px; font-weight: bold;">Payment options:</p>
						<label style="display: block; margin-bottom: 5px;">
							<input type="radio" name="payment-option" checked>
							Pay with portfolio funds
						</label>
						<label style="display: block;">
							<input type="radio" name="payment-option">
							Pay additionally
						</label>
					</div>
				</div>

				<button id="hedgeNowBtn" class="btn btn-gradient btn-round" style="margin-top: 20px;">Hedge now</button>
			</div>
		</div>

		<!-- Confirmation Popup -->
		<div id="popup-hedge-confirmation-overlay" class="popup-overlay">
			<div id="popup-hedge-confirmation" class="popup" style="max-width: 500px; text-align:center;">
				<img src="images/solana-sol-logo.png" alt="Solana" style="width:70px; margin-bottom:15px;">
				<h2 style="margin-bottom: 10px;">Confirm transaction in your wallet</h2>
				<p style="font-style: italic; margin-bottom: 20px;">
					Please check your wallet to approve this transaction.
				</p>
			</div>
		</div>

		<!-- Result Popup -->
		<div id="popup-hedge-result-overlay" class="popup-overlay">
			<div id="popup-hedge-result" class="popup" style="max-width: 500px; text-align:center;">
				<img src="images/+.png" alt="Success" style="width:70px; margin-bottom:15px;">
				<h2 style="margin-bottom: 10px;">Hedge completed successfully!</h2>
				<p style="margin-bottom: 20px;">Manage it via Dashboard.</p>
				<button class="btn btn-gradient btn-round" style="margin-bottom:10px;" onclick="document.querySelectorAll('.popup-overlay').forEach(o => o.style.display='none')">
					Go to Dashboard
				</button>
				<button class="btn btn-round" style="background-color:#1a2a50; border:1px solid #9ac31c; color:#9ac31c;">
					Share on Twitter
				</button>
			</div>
		</div>
		<audio id="popup-sound" src="effects/fanfare.mp3" preload="auto"></audio>

		<!-- <div id="popup-hedge-error-overlay" class="popup-overlay" style="display:none;">
		<div id="popup-hedge-error" class="popup" style="max-width: 500px; text-align:center;">
			<img src="images/-.png" alt="Error" style="width:70px; margin-bottom:15px;">
			<h2 style="margin-bottom: 10px; color:#ec6320;">Hedge failed!</h2>
			<p style="margin-bottom: 20px;">Please try again later.</p>
			<button class="btn btn-gradient btn-round" style="margin-bottom:10px;"
			onclick="document.querySelectorAll('.popup-overlay').forEach(o => o.style.display='none')">
			Go to Dashboard
			</button>
		</div>
		</div>
		<audio id="popup-error-sound" src="effects/disappointment.mp3" preload="auto"></audio> -->

	<script src="js/main.js" defer></script>

	</body>
</html>
